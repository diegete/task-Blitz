
@if (userData && userData.profile.user_type == 'empleado') { <div class="container">
  <!-- Rectángulo de proyectos -->
  <div class="rectangulo-izquierda">
    <div class="welcome-container">
      <div class="profile-info">
        <img class="img-perfil"
          [src]="userData.profile.image || 'localhost:8000/media/imagen/imagen/por/defecto.jpg'"
          alt="Imagen de perfil"
          class="profile-image"
          (click)="openImageModal()"
        />
        <span>Bienvenido, {{ userData.username }}</span>
      </div>
    </div>
    
    
    <h3>Proyectos:</h3>
    <ul>
      <li *ngFor="let proyecto of userData?.proyectos" 
          [class.selected]="proyecto === selectedProject" 
          (click)="selectProject(proyecto)">
        {{ proyecto.title }}
      </li>
    </ul>
  </div>

  <!-- Rectángulo de tareas -->
  <div class="rectangulo-derecha">
    <h3>Tareas del proyecto seleccionado:</h3>
    <ul *ngIf="selectedProjectTasks.length > 0; else noTareas">
      <li *ngFor="let tarea of selectedProjectTasks" (click)="showTaskDetail(tarea)">
        {{ tarea.tarea.titulo }} <!-- Mostrar el título de la tarea -->
      </li>
    </ul>
    <ng-template #noTareas>
      <p>No hay tareas asignadas para este proyecto o no ha seleccionado ningún proyecto.</p>
    </ng-template>
  </div>
  <button class="chat-open-button" (click)="openChat()">Chat</button>
</div>



}@else {
  <p>No hay datos de usuario.</p>
} 

<div class="modal-2" [class.open]="isChatOpen === true && selectedProject">
  <div class="chat-container">
    
    <h3>Chat del Proyecto</h3>
    <div class="chat-messages">
      <div *ngFor="let msg of chatMessages" [ngClass]="{'self-message': msg.user === userData.username}">
        <strong>{{ msg.user }}:</strong> {{ msg.content }}
      </div>
    </div>
    <div class="chat-input-container">
      <input [(ngModel)]="newMessage" placeholder="Escribe un mensaje" />
      <button (click)="sendMessage()">Enviar</button>
      <button class="close-button" (click)="closeChat()">Cerrar</button>
    </div>
  </div>
</div>

  <!-- Modal para los detalles de la tarea -->
  <div class="modal" [class.open]="isModalOpen">
    <div class="modal-content">
      <h2>Detalles de la Tarea</h2>
      <form [formGroup]="taskUpdateForm" (ngSubmit)="enviarAvance()">
        <p><strong>Título:</strong> {{ selectedTask?.tarea.titulo }}</p>
        <p><strong>Descripción:</strong> {{ selectedTask?.tarea.descripcion }}</p>
        <p><strong>Asignado por:</strong> {{ selectedTask?.asignado_por }}</p>
        <p><strong>Fecha de Asignación:</strong> {{ selectedTask?.fecha_asignacion | date: 'short' }}</p>
        <p><strong>Fecha entrega:</strong> {{ selectedTask?.tarea.fechamax | date: 'short' }}</p>
  
        <!-- Selector de avance con FormControl -->
        <label for="avance">Selecciona el Avance:</label>
        <select id="avance" formControlName="avance" required>
          <option value="iniciada">Iniciada</option>
          <option value="en curso">En Curso</option>
          <option value="finalizada">Finalizada</option>
        </select>
  
        <!-- Botones -->
        <button type="submit" [disabled]="taskUpdateForm.invalid">Enviar Avance</button>
        <button type="button" (click)="closeModal()">Cerrar</button>
      </form>
    </div>
  </div>
  
  


  <!-- Modal de invitaciones pendientes -->
  <div class="modal" [class.open]="isInvitationModalOpen">
    <div class="modal-content">
      <h2>Invitaciones pendientes</h2>
      <ul *ngIf="pendingInvitations.length > 0; else noInvitaciones">
        <li *ngFor="let invitation of pendingInvitations">
          <!-- Asegurarse de que el título del proyecto aparezca -->
          <p><strong>Proyecto:</strong> {{ invitation.project.title }}</p>
          <button (click)="acceptInvitation(invitation.id)">Aceptar</button>
          <button (click)="rejectInvitation(invitation.id)">Rechazar</button>
        </li>
      </ul>
      <ng-template #noInvitaciones>
        <p>No tienes invitaciones pendientes.</p>
      </ng-template>
      <button type="button" (click)="closeInvitationModal()">Cerrar</button>
    </div>
  </div>

  <div class="modal-backdrop" *ngIf="showImageModal">
    <div class="modal-content">
      <span class="close-button" (click)="closeImageModal()"></span>
      <h2>Actualizar Imagen de Perfil</h2>
      <img [src]="userData.profile.image" alt="Imagen de perfil actual" class="profile-img" />
      <input class="form-control" type="file" (change)="onImageSelected($event)" />
      <button (click)="updateProfile()">Actualizar Imagen </button>
      <button class="alter" (click)="closeImageModal()"> Cerrar</button>
    </div>
  </div>
  